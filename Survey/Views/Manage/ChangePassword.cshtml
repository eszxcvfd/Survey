@model ChangePasswordDto
@{
    ViewData["Title"] = "Change Password";
}

<section class="auth-card card-surface">
    <h2 class="md-typescale-headline-medium">Change Password</h2>
    <p class="md-typescale-body-medium" style="margin-bottom: 24px; color: var(--md-sys-color-on-surface-variant);">
        Enter your current password and choose a new one.
    </p>

    @if (!ViewData.ModelState.IsValid)
    {
        <div class="alert alert-error" style="padding: 12px; margin-bottom: 16px; background-color: rgba(179, 38, 30, 0.1); color: var(--md-sys-color-error); border-radius: 8px;">
            <div asp-validation-summary="ModelOnly"></div>
        </div>
    }

    <form asp-action="ChangePassword" asp-controller="Manage" method="post" novalidate>
        @Html.AntiForgeryToken()
        
        <div class="form-row">
            <md-outlined-text-field label="Current Password"
                                    name="CurrentPassword"
                                    type="password"
                                    autocomplete="current-password"
                                    required>
            </md-outlined-text-field>
            <span asp-validation-for="CurrentPassword" class="text-danger md-typescale-body-small"></span>
        </div>

        <div class="form-row">
            <md-outlined-text-field label="New Password"
                                    name="NewPassword"
                                    type="password"
                                    autocomplete="new-password"
                                    required>
            </md-outlined-text-field>
            <span asp-validation-for="NewPassword" class="text-danger md-typescale-body-small"></span>
        </div>

        <div class="form-row">
            <md-outlined-text-field label="Confirm New Password"
                                    name="ConfirmNewPassword"
                                    type="password"
                                    autocomplete="new-password"
                                    required>
            </md-outlined-text-field>
            <span asp-validation-for="ConfirmNewPassword" class="text-danger md-typescale-body-small"></span>
        </div>

        <div class="form-actions">
            <md-filled-button type="submit">Change Password</md-filled-button>
            <md-text-button type="button" onclick="window.location.href='@Url.Action("Profile","Manage")'">
                Cancel
            </md-text-button>
        </div>
    </form>
</section>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}